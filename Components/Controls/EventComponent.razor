
<div class="mb-3">
    <div class="btn-group" role="group" aria-label="Month groups">
        @foreach (var mg in monthGroups)
        {
            <button type="button"
                    class="btn btn-outline-primary @(selectedMonthGroup?.Name == mg.Name ? "active" : "")"
                    aria-pressed="@(selectedMonthGroup?.Name == mg.Name)"
                    @onclick="() => SelectGroup(mg)">
                @mg.Name
            </button>
        }
    </div>
</div>

@if (selectedMonthGroup is not null)
{
    <div class="my-3 text-center">
        <img src="@selectedMonthGroup.ImagePath"
             alt="@selectedMonthGroup.Key"
             class="img-fluid w-100 rounded shadow-sm object-fit-cover"
             style="max-width:300px; height:300px;" />
        <h5 class="mt-2">@selectedMonthGroup.Name</h5>
    </div>
}

<ul class="list-unstyled">
    @if (events != null)
    {
        foreach (var e in events)
        {
            <li class="mb-2">
                <div class="card p-2">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <strong>@e.Name</strong><br />
                            <small class="text-muted">Month: @e.Month</small>
                        </div>
                        <span class="badge bg-@(e.IsFree ? "success" : "secondary")">
                            @(e.IsFree ? "Free" : "Paid")
                        </span>
                    </div>
                </div>
            </li>
        }
    }
</ul>

@code {
    private List<EventDto> events = new();
    private List<MonthGroup> monthGroups = new();
    private MonthGroup? selectedMonthGroup;

    protected override void OnInitialized()
    {
        // Load all groups
        monthGroups = MonthRepository.GetMonthGroups();
        
        // Default select the first one
        selectedMonthGroup = monthGroups.FirstOrDefault();

        // Load events that belong to the first group
        if (selectedMonthGroup is not null)
        {
            var months = selectedMonthGroup.Months;
            events = EventRepository.GetAll()
                .Where(e => months.Contains(e.Month))
                .ToList();
        }
    }

    private void SelectGroup(MonthGroup group)
    {
        selectedMonthGroup = group;
        var months = group.Months;

        // Filter events that belong to the selected group
        events = EventRepository.GetAll()
            .Where(e => months.Contains(e.Month))
            .ToList();
    }
}