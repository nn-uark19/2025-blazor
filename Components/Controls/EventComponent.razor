@inject NavigationManager NavigationManager

<div>
    @foreach (var mg in monthGroups)
    {
        <button type="button" @onclick="() => SelectGroup(mg)">
            @mg.Name@(selectedMonthGroup == mg ? " (selected)" : "")
        </button>
    }
</div>

@if (selectedMonthGroup != null)
{
    <div>
        <img src="@selectedMonthGroup.ImagePath"
             alt="@selectedMonthGroup.Key"
             width="300" height="300" />
        <h3>@selectedMonthGroup.Name</h3>
    </div>
}

@if (events != null && events.Count > 0)
{
    <ul>
        @foreach (var e in events)
        {
            <li>
                <strong>@e.Name</strong>
                Month: @e.Month â€” @(e.IsFree ? "Free" : "Paid")
                <button @onclick="() => EditEvent(e.EventId)">Edit</button>
            </li>
        }
    </ul>
}

@code {
    private List<EventDto> events = new();
    private List<MonthGroup> monthGroups = new();
    private MonthGroup? selectedMonthGroup;

    protected override void OnInitialized()
    {
        monthGroups = MonthRepository.GetMonthGroups();
        selectedMonthGroup = monthGroups.FirstOrDefault();

        if (selectedMonthGroup != null)
        {
            var months = selectedMonthGroup.Months;
            events = EventRepository.GetAll()
                .Where(e => months.Contains(e.Month))
                .ToList();
        }
    }

    private void SelectGroup(MonthGroup group)
    {
        selectedMonthGroup = group;
        var months = group.Months;
        events = EventRepository.GetAll()
            .Where(e => months.Contains(e.Month))
            .ToList();
    }

    private void EditEvent(int id)
    {
        // navigate to the edit page with the event id
        NavigationManager.NavigateTo($"/events/edit/{id}");
    }
}