@* ProjectFeatures: a self-contained collapsible panel showing the project's features (ordered basic → advanced) *@
<div class="project-features mb-3">
    <button class="btn btn-link p-0 d-inline-flex align-items-center" @onclick="Toggle" @onkeydown="HandleKeyDown" aria-expanded="@_expanded" aria-controls="@_panelId">
        <span class="chev me-2 @(_expanded ? "rotated" : "")">▶</span>
        <span class="fw-bold">Project features (click to close) </span>
    </button>

    <div id="@_panelId" class="collapse @(_expanded ? "show" : "")">
        <div class="card card-body mt-2">
            <ul class="mb-0">
                <li>
                    <strong>List rendering (basic)</strong> — Uses <code>Virtualize</code> for efficient rendering and includes <code>key</code> on items to preserve identity and reduce re-renders.
                </li>
                <li>
                    <strong>Interactive components & view state</strong> — Child components (month list, event items) raise callbacks and the page maintains the selected/month state so the UI stays in sync.
                    <ul class="mb-0 mt-2">
                        <li>
                            <small>
                                <strong>Search</strong> — Filters events as you type and updates results immediately; clearing the search restores the list filtered by the currently selected month. <span class="badge bg-success ms-2">UX win</span>
                            </small>
                        </li>
                        <li>
                            <small>
                                <strong>Month selection</strong> — Clicking a month clears any active search and shows only events for that month group, making navigation predictable and fast.
                            </small>
                        </li>
                    </ul>
                </li>
                <li>
                    <strong>Form handling & validation</strong> — Add/Edit pages use <code>EditForm</code>, data annotations and validation messages to validate inputs before submitting.
                </li>
                <li>
                    <strong>Server interactivity (advanced)</strong> — The app architecture supports server-side interactions (repository/service calls) and can be extended to async/remote APIs or SignalR for realtime updates.
                </li>
            </ul>
        </div>
    </div>
</div>

@code {
    [Parameter] public bool StartExpanded { get; set; }

    private bool _expanded;
    private readonly string _panelId = "project-features-" + Guid.NewGuid().ToString("N");

    protected override void OnInitialized()
    {
        _expanded = StartExpanded;
    }

    private void Toggle()
    {
        _expanded = !_expanded;
    }

    private void HandleKeyDown(KeyboardEventArgs e)
    {
        if (e.Key == "Enter" || e.Key == " ")
        {
            Toggle();
        }
    }
}
